<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>订单测试</title>
    <meta content="webkit" name="renderer">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
    <link href="/dist/layuiadmin/layui/css/layui.css" media="all" rel="stylesheet">
    <link href="/static/admin/css/admin.css" rel="stylesheet">
</head>
<body>

<div id="laytpl-add-skma" type="text/html">
    <form lay-filter="form-add-skma" class="layui-form model-form no-padding">
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">商户:</label>
            <div class="layui-input-block">
                <select id="account">
                    <option value="0">请选择商户</option>
                    [[foreach name="merchant_list" item="vo"]]
                    <option value="[[$vo.account]]">[[$vo.nickname]]</option>
                    [[/foreach]]
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">银行:</label>
            <div class="layui-input-block">
                <select id="bank">
                    [[foreach name="bank_list" item="vo"]]
                    <option value="[[$vo.bank_code]]">[[$vo.bank_name]]</option>
                    [[/foreach]]
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">响应格式:</label>
            <div class="layui-input-block">
                <select id="format">
                    <option value="json">json</option>
                    <option value="page">page</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">通道:</label>
            <div class="layui-input-block">
                <input id="channel" class="layui-input" readonly value="303"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">金额:</label>
            <div class="layui-input-block">
                <input id="money" class="layui-input" placeholder="请输入金额" value="1.00"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label layui-form-required">回调地址:</label>
            <div class="layui-input-block">
                <input id="notify_url" class="layui-input" readonly value="[[$Think.ADMIN_URL]]/pay/notify"/>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <div id="payBtn" class="layui-btn layui-btn-normal">下单</div>
            </div>
        </div>
    </form>
</div>



<!--引用其他js文件-->
<script src="/dist/layuiadmin/layui/layui.js"></script>
<script src="/static/admin/js/func.js"></script>
<script src="/js/global.js"></script>
<script src="/js/func.js"></script>
<script src="/js/md5.js"></script>


<script>
    layui.use(['table', 'jquery', 'form'], function () {
        var $ = layui.jquery;
        var table = layui.table;
        var form = layui.form;
        var layer = layui.layer;

        <!--触发搜索按钮-->
        $('#payBtn').on('click', function () {
            var item = {};
            item.account = $('#account').val();
            item.bank = $.trim($('#bank').val());
            item.channel = $.trim($('#channel').val());
            item.format = $.trim($('#format').val());
            item.money = $.trim($('#money').val());
            item.notify_url = $.trim($('#notify_url').val());

            if (item.account === '0') {
                alertWarning('请选择商户');
                return;
            }

            ajax({
                url: '[[$Think.ADMIN_URL]]/pay/test',
                data: item,
                success: function (res) {
                    console.log(res);
                    if (res.code !== '0') {
                        alertError(res.msg);
                        return;
                    }
                    alertSuccess(res.msg);
                }
            });
        });

    });
</script>

</body>
</html>
